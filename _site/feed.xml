<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2021-11-20T08:43:07+00:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Dean Robinson</title><subtitle>My Portfolio and Blog</subtitle><author><name>Dean Robinson</name></author><entry><title type="html">Creating my New Blog!</title><link href="http://localhost:4000/blog/My-New-Blog/" rel="alternate" type="text/html" title="Creating my New Blog!" /><published>2021-11-12T00:00:00+00:00</published><updated>2021-11-12T00:00:00+00:00</updated><id>http://localhost:4000/blog/My-New-Blog</id><content type="html" xml:base="http://localhost:4000/blog/My-New-Blog/">&lt;p&gt;Blog post about creating this blog&lt;/p&gt;</content><author><name>Dean Robinson</name></author><category term="Blog" /><category term="Jekyll" /><category term="GitHub" /><category term="Web Design" /><summary type="html">Blog post about creating this blog</summary></entry><entry><title type="html">NLP in PowerBI</title><link href="http://localhost:4000/blog/NLP-in-PowerBI/" rel="alternate" type="text/html" title="NLP in PowerBI" /><published>2021-02-25T00:00:00+00:00</published><updated>2021-02-25T00:00:00+00:00</updated><id>http://localhost:4000/blog/NLP-in-PowerBI</id><content type="html" xml:base="http://localhost:4000/blog/NLP-in-PowerBI/">&lt;blockquote&gt;
  &lt;p&gt;With great Power BI comes great responsibility&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;it-is-time-power-bi--python--amazing&quot;&gt;It is time: Power BI + Python = Amazing!&lt;/h3&gt;

&lt;p&gt;It worked, it is relatively easy to convert the code to run within Power BI. The main thing that changes is the emphasis of using print() or exporting data in some ways things are easier in that you just need to update or create data frames so üêºs is key‚Ä¶ Pandas.&lt;/p&gt;

&lt;p&gt;In terms of a step by step guide the first thing I did was get the code working in Jupyter as a proof that the code will execute successfully.&lt;/p&gt;

&lt;h3 id=&quot;following-on-from-using-spacy&quot;&gt;Following on from using spaCy.&lt;/h3&gt;

&lt;p&gt;When you add a Python Script to a Power BI Query it basically takes the data as it stands in the previous step and converts it to a data frame called dataset. This means that for the code I had for spaCy the name ‚Äúdf‚Äù needed to be changed to ‚Äúdataset‚Äù.&lt;/p&gt;

&lt;p&gt;The other thing that needs to be different is what you do with the outputs of your code. I previously was printing out the values to test that it was working which does not work with what we need for Power BI. Another common way of using python is to output to a CSV or summarize in a visual but again this is not something that we want to do when using Python scripts with Power BI Queries (Python with visuals is a whole other conversation). The solution is to either update a the dataset data frame or to create a new dataframe that stores your outputs. In the case of NLP we are taking text and splitting it up into component parts as rows so outputting to a new dataframe is the easiest way to do this - the advantage with Power BI is that you can always load your data in as another table an join your Python powered query outputs back to it which is really useful.&lt;/p&gt;

&lt;p&gt;I created a list called ‚Äúdata‚Äù to store the outputs of the for loop and then a last step to create a new data frame called ‚Äúnew_df‚Äù. Hopefully the following comparison should make sense of the differences here. The other thing to mention is that I have added the dependencies above the code like you would in Jupiter but Power BI is like a standard Python Script so you need to all code needs to be in one step.&lt;/p&gt;

&lt;h3 id=&quot;previous-position-of-speech-code&quot;&gt;Previous Position of Speech Code&lt;/h3&gt;
&lt;noscript&gt;&lt;pre&gt;400: Invalid request&lt;/pre&gt;&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/a81e176f18bd11dc90f8b3ffb4b53b69.js&quot;&gt; &lt;/script&gt;

&lt;h3 id=&quot;putting-this-in-power-bi&quot;&gt;Putting this in Power BI&lt;/h3&gt;
&lt;p&gt;Hopefully this next step should be simple. To get stuff running in Jupyter you will have needed to install the modules etc. so as long as Power BI is using the same Python environment that you are this should work fine.&lt;/p&gt;

&lt;p&gt;First step is to extract and load your data - this is pretty core to Power BI so I am not going to go through it other than to say that the code here is the same as with the spaCy example and expecting a inputs of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;id|text&lt;/code&gt; with those headers and only those columns. If you have more columns that you want to include do it in another query and join in your data model - the same is true if you have two (or more) text columns you can either add them all as sperare queries.&lt;/p&gt;

&lt;p&gt;The source I am using is on SharePoint and is a CSV but the advantage of using Power Query on this is it is very easy to pull in data from wherever you want. The data has been processed and converted including filtering out blanks (even though the code will also check for this).&lt;/p&gt;

&lt;p&gt;Once your data looks like this:
&lt;img src=&quot;http://localhost:4000/assets/images/posts/2021-02-25-DataView.webp&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;
Click on the Transform tab and the Run Python Script button in the far right:
&lt;img src=&quot;http://localhost:4000/assets/images/posts/2021-02-25-Transform.webp&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;
Paste your code into the box that pops up and click on OK to run. Once the preview has loaded you will see a list of data frames, one is the original data set and the other is the new_df frame the script created:
&lt;img src=&quot;http://localhost:4000/assets/images/posts/2021-02-25-DataView2.webp&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;
To load the new_df data you can just click on table in the corresponding value column and that import the data frame and automatically do things like changing data types:
&lt;img src=&quot;http://localhost:4000/assets/images/posts/2021-02-25-DataView3.webp&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;
Then you can load that to your model and join it up with other data sets and if you include both way filters can do some really cool stuff:
&lt;img src=&quot;http://localhost:4000/assets/images/posts/2021-02-25-DataModel.webp&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see I have included in this template NER (code bellow), RAKE which I will do a separate posts about and TextBlob which is sentiment analysis and something that there will be many more posts about!&lt;/p&gt;
&lt;h3 id=&quot;named-entity-recognition-power-bi-code&quot;&gt;Named Entity Recognition Power BI Code&lt;/h3&gt;
&lt;noscript&gt;&lt;pre&gt;400: Invalid request&lt;/pre&gt;&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/68a5fdd61221a67cdaa575db53f1d4aa.js&quot;&gt; &lt;/script&gt;</content><author><name>Dean Robinson</name></author><category term="Blog" /><category term="Python" /><category term="Natural Language Processing" /><category term="Power BI" /><category term="spaCy" /><category term="pandas" /><summary type="html">How to use Python Natural Language Processing (NLP) in Power BI!</summary></entry><entry><title type="html">Lost in spaCy</title><link href="http://localhost:4000/blog/Lost-in-spaCy/" rel="alternate" type="text/html" title="Lost in spaCy" /><published>2021-02-24T00:00:00+00:00</published><updated>2021-02-24T00:00:00+00:00</updated><id>http://localhost:4000/blog/Lost-in-spaCy</id><content type="html" xml:base="http://localhost:4000/blog/Lost-in-spaCy/">&lt;blockquote&gt;
  &lt;p&gt;In spaCy no one can hear you scream‚Ä¶ &lt;br /&gt;when you get a Syntax error.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Experiments with spaCy are going well in the appropriately named Jupyter notebooks.&lt;/p&gt;

&lt;p&gt;There are two spaCy Natural Language Processing (NLP) components I am working with 1) Position of Speech (POS) and 2) Named Entity Recognition&lt;/p&gt;

&lt;p&gt;This tutorial was really helpful in generalising the experiments I have been doing and looking at different aspects and capabilities of NLP.&lt;/p&gt;

&lt;p&gt;The idea with this is to get a general set of tools developed in a notebook before looking at adapting the code to be used in Power BI to run NLP as a step in Power Query.&lt;/p&gt;

&lt;p&gt;The big question is if you can load the NLP language library into Python running in Power BI (if not it is going to be tricky).&lt;/p&gt;
&lt;h3 id=&quot;starting-point&quot;&gt;Starting Point&lt;/h3&gt;
&lt;p&gt;So I am starting from an example here where NLP tools have been used to get an overview count of the contents of a csv of text values - which is great - but not what I need for a Power BI report to be able to explore the context of the results further so the following is simplified to just return the results of the NLP steps per result.&lt;/p&gt;

&lt;p&gt;With the following I am assuming that you know the basics of installing modules and have done some introductory Python stuff all of which is very widely available online.&lt;/p&gt;

&lt;p&gt;The files and code is all available on &lt;a href=&quot;https://github.com/drdataanalysis/blog_python-text-analysis&quot;&gt;GitHub&lt;/a&gt;&lt;/p&gt;

&lt;noscript&gt;&lt;pre&gt;400: Invalid request&lt;/pre&gt;&lt;/noscript&gt;
&lt;script src=&quot;https://gist.github.com/a81e176f18bd11dc90f8b3ffb4b53b69.js&quot;&gt; &lt;/script&gt;</content><author><name>Dean Robinson</name></author><category term="Blog" /><category term="Python" /><summary type="html">Post covering getting started with spaCy in Python for Natural Language Processing (NLP)</summary></entry><entry><title type="html">Starting Py-Fun!</title><link href="http://localhost:4000/blog/Starting-PyFun/" rel="alternate" type="text/html" title="Starting Py-Fun!" /><published>2021-02-22T00:00:00+00:00</published><updated>2021-02-22T00:00:00+00:00</updated><id>http://localhost:4000/blog/Starting-PyFun</id><content type="html" xml:base="http://localhost:4000/blog/Starting-PyFun/">&lt;h2 id=&quot;-the-idea&quot;&gt;üí° The Idea&lt;/h2&gt;
&lt;blockquote&gt;
  &lt;p&gt;I wanted a way to document and encourage practicing of my experiments with Python and integrating it with Azure ML, Power BI which is a major project I am currently working on.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;-the-plan&quot;&gt;üìã The Plan&lt;/h2&gt;
&lt;p&gt;I am going to blog as regularly as possible covering the Python exploration and investigation that I am doing.&lt;/p&gt;

&lt;p&gt;The plan is to help document the challenges and experience of trying to work to bring Python into the Microsoft Power Platform and processes that are used in my team. This area is something that I have not found many resources about in my work so far so I am conscious that some of this may be of help to others which is another reason to put this into a blog.&lt;/p&gt;

&lt;h2 id=&quot;-next-steps&quot;&gt;üë£ Next Steps&lt;/h2&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;del&gt;Publish this post&lt;/del&gt;&lt;/li&gt;
  &lt;li&gt;Start looking at Natural Language Processing in Python (using Jupyter notebooks)&lt;/li&gt;
  &lt;li&gt;Convert Jupyter code to Power BI for use in data models&lt;/li&gt;
&lt;/ol&gt;</content><author><name>Dean Robinson</name></author><category term="Blog" /><category term="Python" /><summary type="html">Intro to the blog and the work that I am planning to do with Python</summary></entry></feed>